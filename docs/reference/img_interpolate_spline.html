<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interpolate spline — img_interpolate_spline • tfaddons</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interpolate spline — img_interpolate_spline" />
<meta property="og:description" content="Interpolate signal using polyharmonic interpolation." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tfaddons</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.10.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/NMT.html">Neural Machine Translation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/henry090/tfaddons/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interpolate spline</h1>
    <small class="dont-index">Source: <a href='https://github.com/henry090/tfaddons/blob/master/R/image_ops.R'><code>R/image_ops.R</code></a></small>
    <div class="hidden name"><code>img_interpolate_spline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Interpolate signal using polyharmonic interpolation.</p>
    </div>

    <pre class="usage"><span class='fu'>img_interpolate_spline</span>(
  <span class='no'>train_points</span>,
  <span class='no'>train_values</span>,
  <span class='no'>query_points</span>,
  <span class='no'>order</span>,
  <span class='kw'>regularization_weight</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>name</span> <span class='kw'>=</span> <span class='st'>"interpolate_spline"</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>train_points</th>
      <td><p>`[batch_size, n, d]` float `Tensor` of n d-dimensional
locations. These do not need to be regularly-spaced.</p></td>
    </tr>
    <tr>
      <th>train_values</th>
      <td><p>`[batch_size, n, k]` float `Tensor` of n c-dimensional
values evaluated at train_points.</p></td>
    </tr>
    <tr>
      <th>query_points</th>
      <td><p>`[batch_size, m, d]` `Tensor` of m d-dimensional locations
where we will output the interpolant's values.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>order of the interpolation. Common values are 1
for `\(\phi(r) = r\), 2 for \(\phi(r) = r^2 * log(r)\) (thin-plate spline), or 3 for \(\phi(r) = r^3\)`.</p></td>
    </tr>
    <tr>
      <th>regularization_weight</th>
      <td><p>weight placed on the regularization term. This will
depend substantially on the problem, and it should always be tuned. For many problems,
it is reasonable to use no regularization. If using a non-zero value, we recommend
a small value like 0.001.</p></td>
    </tr>
    <tr>
      <th>name</th>
      <td><p>name prefix for ops created by this function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>`[b, m, k]` float `Tensor` of query values. We use train_points and train_values
to perform polyharmonic interpolation. The query values are the values of the interpolant
evaluated at the locations specified in query_points.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The interpolant has the form
f(x) = `\sum_i = 1^n w_i \phi(||x - c_i||) + v^T x + b`. This is a sum of two terms:
(1) a weighted sum of radial basis function
(RBF) terms, with the centers \(c_1, ... c_n\), and (2) a linear term
with a bias. The \(c_i\) vectors are 'training' points.
In the code, b is absorbed into v
by appending 1 as a final dimension to x. The coefficients w and v are
estimated such that the interpolant exactly fits the value of the function
at the \(c_i\) points, the vector w is orthogonal to each \(c_i\),
and the vector w sums to 0. With these constraints, the coefficients
can be obtained by solving a linear system. `\(\phi\)` is an RBF, parametrized by
an interpolation
order. Using order=2 produces the well-known thin-plate spline. We also provide the
option to perform regularized interpolation. Here, the
interpolant is selected to trade off between the squared loss on the
training data and a certain measure of its curvature
([details](https://en.wikipedia.org/wiki/Polyharmonic_spline)).
Using a regularization weight greater than zero has the effect that the
interpolant will no longer exactly fit the training data. However, it may
be less vulnerable to overfitting, particularly for high-order
interpolation. Note the interpolation procedure is differentiable with respect to all
inputs besides the order parameter. We support dynamically-shaped inputs,
where batch_size, n, and m are NULL
at graph construction time. However, d and k must be known.</p>
    <h2 class="hasAnchor" id="this-is-a-sum-of-two-terms"><a class="anchor" href="#this-is-a-sum-of-two-terms"></a>This is a sum of two terms</h2>

    <p>(1) a weighted sum of radial basis function:
(RBF) terms, with the centers \(c_1, ... c_n\), and (2) a linear term with a bias.
The \(c_i\) vectors are 'training' points. In the code, b is absorbed into v by
appending 1 as a final dimension to x. The coefficients w and v are estimated such
that the interpolant exactly fits the value of the function at the \(c_i\) points,
the vector w is orthogonal to each \(c_i\), and the vector w sums to 0. With these
constraints, the coefficients can be obtained by solving a linear system.</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Turgut Abdullayev.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


